<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Machine Installation/Commissioning Report</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" type="text/css" href="./installation.css">
  
  </head>
<body>
<div class="container">
  <center><img src="./sil.png" alt="Company Logo"></center>
  
  <h1>Machine Installation/Commissioning Report</h1>
  <form id="report-form" onsubmit="submitForm(event)"  action="https://script.google.com/macros/s/AKfycbxe5tPmTW0RGTQ7MAyf38WjeaTnjdvgqKGav1eeZm7pFmAiqloOzecuCOrgSjQL90UbKQ/exec" >
    <input type="hidden" id="Token Number" name="Token Number">
<div class="report-details">
           <table>
      <tr>
        <td><label for="customer-name"> Customer Name*:</label></td>
        <td><input type="text" placeholder="Enter Customer Name*" id="customer-name" name="customer-name" required required size="40" ></td>
        <td><label for="contact-person">Contact Person*:</label></td>
        <td><input type="text" placeholder="Enter Contact Person*" id="contact-person" name="contact-person" required required size="40"></td>
      </tr>
      <tr>
        <td><label for="Start-date">Start Date*:</label></td>
        <td><input type="date" id="Start-date" name="Start-date" required required size="40"></td>
        <td><label for="End-date">End Date*:</label></td>
        <td><input type="date" id="End-date" name="End-date" required required size="40"></td>
      </tr>
      <!-- Add this code within the <form> element, after the End Date input -->
      <tr>
        <td><label for="no-of-days">Number of Working Days*:</label></td>
        <td><input type="text" placeholder="Enter Number of Working Days*" id="no-of-days" name="no-of-days" required ></td>
        <!-- <td><button type="button" onclick="editNumberOfDays()">Edit</button></td> -->
      </tr>

      <tr>              
        <td><label for="Engineer-Name">Engineer Name*:</label></td>
        <td><input type="text" placeholder="Enter Engineer Name*" id="Engineer-Name" name="Engineer-Name" required required size="30"></td>
        <td><label for="City-Name">City Name*:</label></td>
        <td><input type="text" placeholder="Enter City Name*" id="City-Name" name="City-Name" required required size="40"></td>
      </tr>
      <tr>
        <td><label for="machine-model">Machine Model*:</label></td>
        <td><input type="text" placeholder="Enter Machine-Model*" id="machine-model" name="machine-model" required required size="40"></td>
        <td><label for="machine-Serial Number">Machine Serial Number*:</label></td>
        <td><input type="text" placeholder="Enter Serial Number*" id="machine-Serial Number" name="machine-Serial Number" required ></td>
      </tr>
      <tr>
        <td colspan="4" style="text-align: center;"><label for="machine-type">Machine Type*:</label></td>
      </tr>
      <tr>
        <td colspan="4" style="text-align: center;">
          <select id="machine-type" name="machine-type" required>
            <option value="">Machine Type*</option>
            <option value="2 Chuk tube Cutting">2 Chuck tube Cutting</option>
            <option value="3 Chuk tube Cutting">3 Chuck tube Cutting</option>
            <option value="Linear Motor Machine">Linear Motor Machine</option>
            <option value="Fanuc sheet Cutting">Fanuc sheet Cutting</option>
            <option value="Backhoff sheet Cutting">Backhoff sheet Cutting</option>
            <option value="Ecat sheet Cutting">Ecat sheet Cutting</option>
            <option value="Combo Machine">Combo Machine</option>
            <option value="SPM">SPM</option>
            <option value="Other">Other</option>
            <!-- Add more options as needed -->
          </select>
          
        </td>
      </tr>
    </table>
    <br>
  </div>
  <div class="report-table">
    <table id="thickness-table">
      <thead>
        <tr>
          <th>Cutting Material</th>
          <th>Thickness (mm)</th>
          <th>Result</th>
          <th>Remark</th>
        </tr>
      </thead>
      <tbody id="thickness-table-body">
        <!-- Default row without trials column -->
        <tr>
          <td>
            <select name="material-1">
              <option value="Mild Steel">Mild Steel</option>
              <option value="stainless Steel">Stainless Steel</option>
              <option value="Aluminum">Aluminum</option>                
              <option value="Titanium">Titanium</option>
              <option value="Galvanized">Galvanized</option>
              <option value="Copper">Copper</option>
              <option value="Brass">Brass</option>
              <!-- Add more options as needed -->
            </select>
          </td>
          <td><input type="text" name="thickness-1" placeholder="Enter Thickness"> mm</td>
          <td>
            <select name="result-1">
              <option value="OK">OK</option>
              <option value="Not OK">Not OK</option>
              <!-- Add more options as needed -->
            </select>
          </td>
          <td><input type="text" name="remark-1" placeholder="Enter Remark"></td>
        </tr>
      </tbody>
    </table><br>
    <button type="button" onclick="addRow()" id="add-thickness-button" class="add-buttons">Add Thickness</button>
      </table>

  </div>
      <table>
      <!-- Machine Details Form content from the second snippet -->
      
      <div class="table">
        <div class="row header">
          <div class="cell">Machine Function</div>
          <div class="cell">WORKING</div>
          <div class="cell">Remark (Model No. - Serial No.)</div>
          </div>
        <div class="row">
          <div class="cell">XYZ_axis</div>
          <div class="cell"><input type="text" name="xyz_axis" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="xyz_axis"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">Pallet_Changer</div>
          <div class="cell"><input type="text" name="pallet_changer" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="pallet_changer"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">CNC</div>
          <div class="cell"><input type="text" name="CNC" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="CNC"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">Laser</div>
          <div class="cell">
              <input type="text" name="Laser" placeholder="Enter working status">
          </div>
          <div class="cell">
              <input type="text" name="Laser_remark_model" placeholder="Model No.">
              <input type="text" name="Laser_remark_serial" placeholder="Serial No.">
          </div>
      </div>
        <div class="row">
          <div class="cell">Chiller</div>
          <div class="cell"><input type="text" name="Chiller" placeholder="Enter working status">
          </div>
          <div class="cell">
            <input type="text" name="Chiller"placeholder="Model No.">
            <input type="text" name="Chiller"placeholder="Serial No."></div>
        </div>
        <div class="row">
          <div class="cell">Cutting_Head</div>
          <div class="cell"><input type="text" name="Cutting_Head" placeholder="Enter working status"></div>
          <div class="cell">
            <input type="text" name="Cutting_Head"placeholder="Model No.">
            <input type="text" name="Chiller"placeholder="Serial No."></div>
        </div>
        <div class="row">
          <div class="cell">Dust Collector</div>
          <div class="cell"><input type="text" name="Dust Collector" placeholder="Enter working status"></div>
          <div class="cell">
            <input type="text" name="Dust Collector"placeholder="Model No.">
            <input type="text" name="Dust Collector"placeholder="Serial No."></div>
        </div>
        <div class="row">
          <div class="cell">Slat Conveyer</div>
          <div class="cell"><input type="text" name="Slat Conveyer" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="Slat Conveyer"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">Panel AC</div>
          <div class="cell"><input type="text" name="Panel AC" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="Panel AC"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">Lubrication System</div>
          <div class="cell"><input type="text" name="Lubrication System" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="Lubrication System"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">Exhaust System</div>
          <div class="cell"><input type="text" name="Exhaust System" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="Exhaust System"placeholder="Enter remark"></div>
        </div>
        <div class="row">
          <div class="cell">Tool Kit</div>
          <div class="cell"><input type="text" name="Toll Kit" placeholder="Enter working status"></div>
          <div class="cell"><input type="text" name="Toll Kit"placeholder="Enter remark"></div>
        </div> 
        <!-- Add more rows as needed -->
      </tbody>
      </table>
    <br>
       <!-- Power Supply Details Form -->
       <div class="table">
        <div class="row header">
          <div class="cell">Power Supply<span class="mandatory"></span>*</div>
          <div class="cell">Standard value<span class="mandatory"></span>*</div>
          <div class="cell">Actual Readings<span class="mandatory"></span>*</div>
          <div class="cell">Remarks<span class="mandatory"></span>*</div>
        </div>
        <div class="row">
          <div class="cell">Phase to Phase<span class="mandatory"></span>*</div>
          <div class="cell">400/415VAC<span class="mandatory"></span>*</div>
          <div class="cell"><input type="text" name="phaseToPhase" placeholder="Actual Readings*" required></div>
          <div class="cell"><input type="text" name="phaseToPhase" placeholder="Enter remark*" required></div>
        </div>
        <div class="row">
          <div class="cell">Phase to Neutral<span class="mandatory"></span>*</div>
          <div class="cell">220/240VAC<span class="mandatory"></span>*</div>
          <div class="cell"><input type="text" name="phaseToNeutral" placeholder="Actual Readings*" required></div>
          <div class="cell"><input type="text" name="phaseToNeutral" placeholder="Enter remark*" required></div>
        </div>
        <div class="row">
          <div class="cell">Phase to Earth<span class="mandatory"></span>*</div>
          <div class="cell">220/240VAC<span class="mandatory"></span>*</div>
          <div class="cell"><input type="text" name="phaseToEarth" placeholder="Actual Readings*" required></div>
          <div class="cell"><input type="text" name="phaseToEarth" placeholder="Enter remark*" required></div>
        </div>
        <div class="row">
          <div class="cell">Neutral to Earth<span class="mandatory"></span>*</div>
          <div class="cell">Less than 1 Volts<span class="mandatory"></span>*</div>
          <div class="cell"><input type="text" name="neutralToEarth" placeholder="Actual Readings*" required></div>
          <div class="cell"><input type="text" name="neutralToEarth" placeholder="Enter remark*" required></div>
        </div>
        <div class="row">
          <div class="cell">Earth Resistance<span class="mandatory"></span>*</div>
          <div class="cell">Less than 3 ohms<span class="mandatory"></span>*</div>
          <div class="cell"><input type="text" name="earthResistance" placeholder="Actual Readings*" required></div>
          <div class="cell"><input type="text" name="earthResistance" placeholder="Enter remark*" required></div>
        </div>
      </div>
            
    
<table>
    <tr>
      <th>General Capabilities</th>
      <th>Options</th>
      <th>Remarks</th>
    </tr>
    <tr>
      <td>Max Cutting Length</td>
      <td>As per Machine bed size</td>
      <td><input type="text" name="As per Machine bed size"placeholder="Enter remark"></td>
    </tr>
    <tr>
      <td>Max Cutting Width</td>
      <td>As per Machine bed size</td>
      <td><input type="text" name="As per Machine bed size"placeholder="Enter remark"></td>
    </tr>
    <tr>
      <td>Cutting Tolerance</td>
      <td>Â± 0.1 mm</td>
      <td><input type="text" name="Cutting Tolerance"placeholder="Enter remark"></td>
    </tr>
    
    <tr>
      <td>Repeatability</td>      
      <td>0.05 mm (MAX)</td>
      <td><input type="text" name="Repeatability"placeholder="Enter remark"></td>
    </tr>
    <tr>
      <td>Circular Accuracy</td>      
      <td>Within 0.1mm</td>
      <td><input type="text" name="Curcular Accuracy"placeholder="Enter remark"></td>
    </tr>
    <tr>
      <td>Diagonal</td>
      <td>0.5mm (1500x3000mm)</td>
      <td><input type="text" name="Diagonal"placeholder="Enter remark"></td>
    </tr>
      </div>
      <div class="row">
        <!-- Power Supply Details content from the third snippet -->
      </div>
    </div>
    <br>
     
    <!-- <h2>Machine Specifications</h2> -->
    <table>
    <table>
  <tr>
    <th>Parameter</th>
    <th>Range/Description</th>
    <th>Remark</th>
  </tr>
  <tr>
    <td>Chiller Temperature</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>a) Laser Source cooling water Temp</td>
    <td>22-25</td>
    <td><input type="text" name="laser_temp_remark" placeholder="Enter remark"></td>
  </tr>
  <tr>
    <td>b) Cutting Head Cooling water Temp</td>
    <td>28-32</td>
    <td><input type="text" name="cutting_head_temp_remark" placeholder="Enter remark"></td>
  </tr>
  <tr>
    <td>c)Chiller Temperature Alarm</td>
    <td>20 Min, 35 Max</td>
    <td><input type="text" name="Temperature Alarm" placeholder="Enter remark"></td>
  </tr>
  <tr>
    <td>File Format</td>
    <td>DXF/NC/CNC File</td>
    <td><input type="text" name="cutting_head_temp_remark" placeholder="Enter remark"></td>
  </tr>
  <tr>
    <td>Safety Interlock</td>
    <td></td>
    <td><input type="text" name="Safety Interlock" placeholder="Enter remark"></td>
  </tr>
    <tr>
    <td>- Head Temp. Interlock</td>
    <td></td>
    <td><input type="text" name="Head Temp. Interlock" placeholder="Enter remark"></td>
  </tr>
  <tr>
    <td>- Chiller Interlock</td>
    <td></td>
    <td><input type="text" name="Chiller Interlock" placeholder="Enter remark"></td>
  </tr>
  <tr>
    <td>- Cutting Gas Interlock</td>
    <td></td>
    <td><input type="text" name="Cutting Gas Interlock" placeholder="Enter remark"></td>
  </tr>
  <!-- ... (other rows) ... -->
  
</table><br>
<button type="button" onclick="addOtherRow()" style="padding: 10px 20px; background-color: #3498db; color: #fff; border: none; border-radius: 5px; cursor: pointer;" id="addOtherButton" class="add-buttons-hidden">Add Other</button>



<table id="other-table">
  <!-- Existing table content -->
</table>

<table>
  
    <td>Engineer Sign:</td>
    <td><input type="text" name="engineer_sign" ></td>
  </tr>
  <tr>
    <td>Contact Person Sign:</td>
    <td><input type="text" name="contact_person_sign" ></td>
  </tr>
     <td>Contact Person Comment:</td>
    <td colspan="2"><textarea name="comments"  rows="10" cols="90"></textarea></td>
  </tr>
</table>
 

    <!-- Submit button for the entire form -->
    <br>
    <div style="position: absolute; top: 20px; right: 20px;">Token Number: <span id="token-number"></span></div>
    <input type="hidden" id="Token Number" name="Token Number">
           <button class="submit-btn"><i class="material-icons">send</i> Submit</button>
       <button type="button" onclick="goToDashboard()" class="dashboard-btn"><i class="material-icons">dashboard</i> Go to Dashboard</button>
    <!-- </div>
     -->
   
     <script>
      // Function to handle form submission
      document.getElementById('myForm').addEventListener('submit', function(event) {
        // Prevent the default form submission
        event.preventDefault();
        
        // Perform any form processing if needed
  
        // Redirect to the dashboard
        window.location.href = './select.html';
      });
  
      function goToDashboard() {
    // Display a confirmation dialog
    if (confirm("Are you sure you want to go to the dashboard?")) {
      // If the user confirms, redirect to the dashboard
      window.location.href = './select.html';
    }
  }
    </script>
  
      <script>
        function addOtherRow() {
    // Get the table where new rows will be added
    var otherTable = document.getElementById("other-table");
  
    // Create a new table row
    var newRow = document.createElement("tr");
  
    // Create table data for description input
    var descriptionCell = document.createElement("td");
    var descriptionInput = document.createElement("input");
    descriptionInput.type = "text";
    descriptionInput.name = "description"; // Assign a unique name if needed
    descriptionInput.placeholder = "Enter Description";
    descriptionCell.appendChild(descriptionInput);
  
    // Create table data for remark input
    var remarkCell = document.createElement("td");
    var remarkInput = document.createElement("input");
    remarkInput.type = "text";
    remarkInput.name = "remark"; // Assign a unique name if needed
    remarkInput.placeholder = "Enter Remark";
    remarkCell.appendChild(remarkInput);
  
    // Append cells to the new row
    newRow.appendChild(descriptionCell);
    newRow.appendChild(remarkCell);
  
    // Append the new row to the table
    otherTable.appendChild(newRow);
  }
      </script>
      
      <script>
        let pdfGenerated = false; // Variable to track if PDF has been generated
      
        // Function to handle form submission
        function submitForm(event) {
            event.preventDefault();
      
            // Hide placeholders when the submit button is clicked
            hidePlaceholders();
      
            // Check if the PDF has already been generated
            if (pdfGenerated) {
                alert("PDF has already been generated. Please proceed to the next step.");
                return;
            }
      
            // Collect form data (you can use FormData or any method you prefer)
            let formData = new FormData(document.getElementById('report-form'));
      // Validate the number of working days
let startDate = new Date(formData.get('Start-date'));
let endDate = new Date(formData.get('End-date'));
let totalDays = Math.ceil((endDate - startDate) / (24 * 60 * 60 * 1000)) + 1; // Calculate total days
let numberOfDays = formData.get('no-of-days');

// Check if numberOfDays contains only digits
if (!/^\d+$/.test(numberOfDays)) {
    alert("Number of working days must be a positive integer. Please enter a valid number.");
    return;
}

numberOfDays = parseInt(numberOfDays, 10);

if (isNaN(numberOfDays) || numberOfDays <= 0 || numberOfDays > totalDays) {
    alert("Number of working days is invalid. Please make sure it is a positive number and not greater than the total days between the selected start and end dates.");
    return;
}

      
            // Display a confirmation dialog
            if (confirm("Are you sure you want to submit the form?")) {
                // Example: Sending form data via fetch to a Google Apps Script
                fetch('https://script.google.com/macros/s/AKfycbxe5tPmTW0RGTQ7MAyf38WjeaTnjdvgqKGav1eeZm7pFmAiqloOzecuCOrgSjQL90UbKQ/exec', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.text())
            .then(tokenNumber => {
                // Include the token number in your PDF
                console.log('Token Number:', tokenNumber);

                // After the form submission logic, initiate the print
                window.print();
                pdfGenerated = true;
                    // .then(response => {
                    //     // Handle the response from the server if needed
                    //     console.log('Form submitted successfully!', response);
      
                    //     // After the form submission logic, initiate the print
                    //     window.print();
                    //     pdfGenerated = true; // Set the flag to true after successful PDF generation
                        
          // Reset the form after successful submission
          document.getElementById('report-form').reset();
                    })
                    .catch(error => {
                        console.error('Error submitting form:', error);
                    });
            }
            // Function to reset the form
  function resetForm() {
    document.getElementById('report-form').reset();
  }
        }
      
        function updateNumberOfDays() {
            var startDate = new Date(document.getElementById("Start-date").value);
            var endDate = new Date(document.getElementById("End-date").value);
      
            // Calculate the difference in days
            var totalDays = Math.ceil((endDate - startDate) / (24 * 60 * 60 * 1000)) + 1;
      
            // Update the input field for the total days
            document.getElementById("total-days").value = totalDays;
      
            // Calculate the number of working days (excluding weekends)
            var workingDays = 0;
            var currentDate = startDate;
      
            while (currentDate <= endDate) {
                var dayOfWeek = currentDate.getDay();
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    // Count only weekdays (Monday to Friday)
                    workingDays++;
                }
                currentDate.setDate(currentDate.getDate() + 1);
            }
      
            // Update the input field for the number of working days
            document.getElementById("no-of-days").value = workingDays;
        }
      
        // Add an event listener to update the number of working days when the dates change
        document.getElementById("Start-date").addEventListener("change", updateNumberOfDays);
        document.getElementById("End-date").addEventListener("change", updateNumberOfDays);
      
        // Function to hide placeholders
        function hidePlaceholders() {
            var inputs = document.querySelectorAll("input[type=text]");
            inputs.forEach(function (input) {
                input.removeAttribute("placeholder");
            });
        }
      </script>

      <script>
        // Function to add a new row to the thickness table
        function addRow() {
          // Get the thickness table body
          var thicknessTableBody = document.getElementById("thickness-table-body");
      
          // Create a new table row
          var newRow = document.createElement("tr");
      
          // Create table data for cutting material dropdown
          var materialCell = document.createElement("td");
          var materialSelect = document.createElement("select");
          materialSelect.name = "material"; // Assign a unique name if needed
      
          // Add options to the material dropdown
          var materialOptions = ["Mild Steel", "Stainless Steel", "Aluminum", "Titanium", "Galvanized", "Copper", "Brass"];
          for (var i = 0; i < materialOptions.length; i++) {
            var option = document.createElement("option");
            option.value = materialOptions[i];
            option.text = materialOptions[i];
            materialSelect.appendChild(option);
          }
      
          materialCell.appendChild(materialSelect);
      
          // Create table data for thickness input
          var thicknessCell = document.createElement("td");
          var thicknessInput = document.createElement("input");
          thicknessInput.type = "text";
          thicknessInput.name = "thickness"; // Assign a unique name if needed
          thicknessInput.placeholder = "Enter Thickness";
          thicknessCell.appendChild(thicknessInput);
          thicknessCell.innerHTML += " mm";
      
          // Create table data for result dropdown
          var resultCell = document.createElement("td");
          var resultSelect = document.createElement("select");
          resultSelect.name = "result"; // Assign a unique name if needed
      
          // Add options to the result dropdown
          var resultOptions = ["OK", "Not OK"];
          for (var j = 0; j < resultOptions.length; j++) {
            var resultOption = document.createElement("option");
            resultOption.value = resultOptions[j];
            resultOption.text = resultOptions[j];
            resultSelect.appendChild(resultOption);
          }
      
          resultCell.appendChild(resultSelect);
      
          // Create table data for remark input
          var remarkCell = document.createElement("td");
          var remarkInput = document.createElement("input");
          remarkInput.type = "text";
          remarkInput.name = "remark"; // Assign a unique name if needed
          remarkInput.placeholder = "Enter Remark";
          remarkCell.appendChild(remarkInput);
      
          // Append cells to the new row
          newRow.appendChild(materialCell);
          newRow.appendChild(thicknessCell);
          newRow.appendChild(resultCell);
          newRow.appendChild(remarkCell);
      
          // Append the new row to the thickness table body
          thicknessTableBody.appendChild(newRow);
        }
      </script>     
</body>
</html>
